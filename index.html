<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>数字タッチゲーム</title>
    
    <style>
        #board > input {
            width: 100px;
            margin-right: 10px;
        }
    </style>
    
</head>

<body>
	<h1>小さい数字からタッチ</h1>
	<p>Time: <span id = "time"> 0.0 </span> sec. </p>
	<div id = "board"> 	
		<input type = "button" id = "button_0" value = "?" onclick = "touched(0)" >
		<input type = "button" id = "button_1" value = "?" onclick = "touched(1)">
		<input type = "button" id = "button_2" value = "?" onclick = "touched(2)"> <br>
		<input type = "button" id = "button_3" value = "?" onclick = "touched(3)">
		<input type = "button" id = "button_4" value = "?" onclick = "touched(4)">
		<input type = "button" id = "button_5" value = "?" onclick = "touched(5)"> <br>
		<input type = "button" id = "button_6" value = "?" onclick = "touched(6)">
		<input type = "button" id = "button_7" value = "?" onclick = "touched(7)">
		<input type = "button" id = "button_8" value = "?" onclick = "touched(8)"> <br>
	</div>

	<p> <input type = "button" value = "Start!" onclick = "timerStart();"> </p>

	<script> 

		var currentNum;
		var timer;
		var startTime;

		function timerStart () {
			initBoard();
			currentNum = 0; //最初の数字は０なので
			startTime = (new Date()).getTime(); //？？このかっこの意味がよくわからん
			runTimer(); 
		}
		
		function initBoard(){
			var nums = [0, 1, 2, 3, 4, 5, 6, 7, 8];
			var num;
			for (var i=0; i<9; i++) {
			num = nums.splice(Math.floor(Math.random() * nums.length),1);
				//array.splice(index,howmany to be removed,item1,.....,itemX)//
			document.getElementById('button_' + i).value = num[0];
				//splice will return an array, that's why we need [].
				//Even though it's returning only 1 number, it's the first letter of the array
			}
		}

		function touched(n){
			//btnで、今押された番号を指定。'button_' + nのボタンが押されたよ、それはnとしよう。っていう感じ
			var btn = document.getElementById('button_' + n);
			if (btn.value==currentNum){
				btn.disabled = true;
				currentNum++;
			}

			if (currentNum ==9){
				//現在のタッチされた数字が９だったら、timeをとめる
				//clearTimeout methodを使う
				//一定時間後に処理を開始する「setTimeout」メソッドの処理を停止するメソッド。
				//「setTimeout」メソッドの設定で、「ID名=setTimeout(処理,時間設定)」としてID名を設定しておくと、そのID名を「clearTimeout」メソッドで指定することにより、指定したID名の「setTimeout」メソッドの処理を停止できる。
				clearTimeout(time);
				alert('あなたのスコアは' + document.getElementById('time').innerHTML);
			}

		}

		function runTimer(){
			document.getElementById('time').innerHTML = (((new Date()).getTime() - startTime) / 1000).toFixed(1);
			//この時点はまだ、「何秒ごとにtimeの表示を変換」という機能が動いていない。今の時間から、スタートタイムをひいて表示、だけなので、０になってしまう。
			timer = setTimeout(function(){runTimer();},100);
			//とりあえず100ミリセカンド毎にrunTimer();処理をしろっていう命令。runtimer処理は、そもそも今書いてる関数なので、処理する毎にtimeに(現在の時間ーstartTime)を行う。
			}
	</script>

</body>
</html>
